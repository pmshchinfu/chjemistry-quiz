<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è³ªé‡å®ˆæ†å®šå¾‹ - é¾é’åºœè€å¸«</title>
    <style>
        :root { --primary: #2980b9; --success: #27ae60; --error: #e74c3c; --dark: #2c3e50; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', "Microsoft JhengHei", sans-serif; background: var(--bg); margin: 0; display: flex; }
        .sidebar { width: 220px; background: var(--dark); padding: 25px 15px; height: 100vh; position: fixed; display: flex; flex-direction: column; gap: 15px; }
        .sidebar-title { color: white; font-size: 1.2em; text-align: center; margin-bottom: 20px; border-bottom: 1px solid #455a64; padding-bottom: 10px; }
        .sidebar button { padding: 15px; color: white; border: none; border-radius: 8px; cursor: pointer; transition: 0.3s; font-weight: bold; font-size: 16px; text-align: center; }
        .btn-lecture { background: #9b59b6; }
        .btn-quiz { background: var(--success); }
        .btn-home { background: #e67e22; margin-top: auto; }
        .main-content { margin-left: 250px; padding: 40px; flex-grow: 1; display: flex; flex-direction: column; align-items: center; }
        .card { background: white; width: 100%; max-width: 650px; padding: 40px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); text-align: center; }
        .form-group { text-align: left; margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: bold; }
        select, input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; }
        .seat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .question-text { font-size: 22px; margin: 25px 0; text-align: left; line-height: 1.5; }
        .options-grid { display: grid; gap: 12px; }
        .option-btn { padding: 15px; font-size: 18px; border: 2px solid #ddd; border-radius: 10px; background: white; cursor: pointer; text-align: left; }
        #feedback-box { display: none; margin-top: 20px; padding: 20px; border-radius: 10px; text-align: left; }
        .fb-correct { background: #d4edda; border: 2px solid #28a745; color: #155724; }
        .fb-wrong { background: #f8d7da; border: 2px solid #dc3545; color: #721c24; }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-title">è³ªé‡å®ˆæ†å®šå¾‹</div>
        <button class="btn-lecture" onclick="window.open('Conservation_of_mass.pdf', '_blank')">ğŸ“„è¬›ç¾©_è³ªé‡å®ˆæ†å®šå¾‹</button>
        <button class="btn-quiz" onclick="location.reload()">âœï¸ æ¸¬é©—ç·´ç¿’</button>
        <button class="btn-home" onclick="location.href='../index.html'">ğŸ  å›é¦–é </button>
    </div>

    <div class="main-content">
        <div id="login-box" class="card">
            <h2>ğŸ§ª è³ªé‡å®ˆæ†ç²¾ç†Ÿæ¸¬é©—</h2>
            <div class="form-group">
                <label>ç­ç´šï¼š</label>
                <select id="class-select">
                    <option value="">è«‹é¸æ“‡ç­ç´š</option>
                    <option value="801">801</option><option value="802">802</option>
                    <option value="803">803</option><option value="804">804</option><option value="805">805</option>
                </select>
            </div>
            <div class="form-group">
                <label>åº§è™Ÿï¼š</label>
                <div class="seat-grid">
                    <select id="seat-ten">
                        <option value="0">0 (åä½)</option>
                        <option value="1">1</option><option value="2">2</option>
                        <option value="3">3</option><option value="4">4</option><option value="5">5</option>
                    </select>
                    <select id="seat-one">
                        <option value="">(å€‹ä½)</option>
                        <option value="0">0</option><option value="1">1</option><option value="2">2</option>
                        <option value="3">3</option><option value="4">4</option><option value="5">5</option>
                        <option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label>å§“åï¼š</label>
                <input type="text" id="name-input" placeholder="è«‹è¼¸å…¥å§“å">
            </div>
            <button onclick="startQuiz()" style="width:100%; padding:15px; background:var(--success); color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">é–‹å§‹æ¸¬é©—</button>
        </div>

        <div id="quiz-box" class="card" style="display:none;">
            <div id="q-header" style="color:var(--primary); font-weight:bold;"></div>
            <div id="q-text" class="question-text"></div>
            <div id="q-options" class="options-grid"></div>
            <div id="feedback-box">
                <div id="fb-title" style="font-weight:bold; font-size:1.1em;"></div>
                <div id="fb-text" style="margin-top:10px; padding-top:10px; border-top:1px solid rgba(0,0,0,0.1);"></div>
                <button onclick="nextQ()" style="margin-top:15px; padding:10px 30px; background:var(--primary); color:white; border:none; border-radius:8px; cursor:pointer;">ä¸‹ä¸€é¡Œ</button>
            </div>
        </div>

        <div id="result-box" class="card" style="display:none;">
            <h2>æ¸¬é©—å®Œæˆ</h2>
            <h1 id="score-display" style="font-size:72px; color:var(--error);">0 åˆ†</h1>
            <p id="upload-status" style="font-weight:bold; color:var(--primary);">è³‡æ–™è‡ªå‹•ç™»éŒ„ä¸­...</p>
            <button onclick="location.reload()" style="margin-top:20px; padding:12px 25px; border-radius:8px; cursor:pointer;">è¿”å›</button>
        </div>
    </div>

    <script>
        const script_url = "https://script.google.com/macros/s/AKfycbzXkjCD4jdQRzLPrfYahplJ4PaNQi42_glFiugwvO9VCoydokImjFq01yGyl76QxkQ/exec"; 

        const questions = [
            { q: "åå…«ä¸–ç´€ç¢ºç«‹ã€Œè³ªé‡å®ˆæ†å®šå¾‹ã€çš„ç§‘å­¸å®¶æ˜¯èª°ï¼Ÿ", o: ["é“è€³é “", "æ‹‰ç“¦ç¯€", "è«è€³", "é˜¿ä½›åŠ å¾·ç¾…"], a: 1, e: "æ‹‰ç“¦ç¯€é€éç²¾å¯†å¤©å¹³å¯¦é©—ç¢ºç«‹äº†åŒ–å­¸åæ‡‰å‰å¾Œç¸½è³ªé‡ä¸è®Šã€‚" },
            { q: "åœ¨ä¸€èˆ¬åŒ–å­¸åæ‡‰ä¸­ï¼Œåƒèˆ‡åæ‡‰çš„æ‰€æœ‰ç‰©è³ªç¸½è³ªé‡æœƒå¦‚ä½•ï¼Ÿ", o: ["å¢åŠ ", "æ¸›å°‘", "ç¶­æŒæ†å®š", "ä¸ä¸€å®š"], a: 2, e: "æ ¹æ“šè³ªé‡å®ˆæ†å®šå¾‹ï¼Œåæ‡‰ç‰©ç¸½è³ªé‡å¿…ç­‰æ–¼ç”Ÿæˆç‰©ç¸½è³ªé‡ã€‚" },
            { q: "åŒ–å­¸åæ‡‰å‰å¾ŒåŸå­çš„ç¨®é¡èˆ‡æ•¸ç›®ä¸è®Šï¼Œæ˜¯å¼•ç”¨å“ªä¸€å€‹ç†è«–ï¼Ÿ", o: ["åŸå­èªª", "ç›¸å°è«–", "è¬æœ‰å¼•åŠ›", "ç´°èƒå­¸èªª"], a: 0, e: "é“è€³é “åŸå­èªªæŒ‡å‡ºåŸå­ä¸æœƒæ¶ˆå¤±ï¼Œåªæ˜¯é‡æ–°æ’åˆ—çµ„åˆã€‚" },
            { q: "åŒ–å­¸åæ‡‰å‰å¾Œï¼Œä¸‹åˆ—å“ªä¸€é …ã€Œçµ•å°ä¸æœƒã€æ”¹è®Šï¼Ÿ", o: ["åˆ†å­çš„ç¨®é¡", "ç‰©è³ªçš„ç¸½è³ªé‡", "åŸå­æ’åˆ—æ–¹å¼", "ç‰©è³ªæ€§è³ª"], a: 1, e: "åŸå­çš„åº«å­˜æ²’è®Šï¼Œå› æ­¤ç¸½è³ªé‡çµ•å°å®ˆæ†ã€‚" },
            { q: "åŒ–å­¸åæ‡‰å‰å¾Œï¼Œä¸‹åˆ—å“ªä¸€é …ã€Œä¸€å®šæœƒã€æ”¹è®Šï¼Ÿ", o: ["åŸå­å€‹æ•¸", "åŸå­ç¨®é¡", "ç‰©è³ªç¨®é¡", "å…ƒç´ ç¨®é¡"], a: 2, e: "åŒ–å­¸åæ‡‰çš„æœ¬è³ªæ˜¯ç”¢ç”Ÿèˆ‡åŸç‰©è³ªæ€§è³ªä¸åŒçš„æ–°ç‰©è³ªã€‚" },
            { q: "é–‹æ”¾å®¹å™¨ä¸­å¤§ç†çŸ³åŠ é¹½é…¸åæ‡‰å¾Œç§¤é‡è®Šè¼•ï¼Œæ˜¯å› ç‚ºï¼Ÿ", o: ["å®šå¾‹å‡ºéŒ¯", "äºŒæ°§åŒ–ç¢³æ°£é«”é€¸æ•£", "ç”¢ç”Ÿæ–°åŸå­", "å¤§ç†çŸ³æ¶ˆå¤±"], a: 1, e: "æ°£é«”ç”¢ç‰©é€¸æ•£åˆ°ç©ºæ°£ä¸­ï¼Œå°è‡´å¤©å¹³æ¸¬ä¸åˆ°è©²ä»½è³ªé‡ã€‚" },
            { q: "é‹¼çµ²çµ¨ç‡ƒç‡’å¾Œè³ªé‡å¢åŠ ï¼ŒåŸå› ç‚ºä½•ï¼Ÿ", o: ["ç”¢ç”Ÿæ–°åŸå­", "å¸æ”¶äº†ç©ºæ°£ä¸­çš„æ°§æ°£", "ç†±é‡è½‰ç‚ºè³ªé‡", "å¤©å¹³æ•…éšœ"], a: 1, e: "æ°§æ°£çµåˆåˆ°å›ºé«”ä¸­ï¼Œå¢åŠ äº†ç”¢ç‰©çš„ç¸½é‡é‡ã€‚" },
            { q: "è‹¥è¦ç²¾æº–é©—è­‰åæ‡‰å‰å¾Œè³ªé‡ç›¸ç­‰ï¼Œæ‡‰å„ªå…ˆé¸æ“‡å“ªç¨®ç’°å¢ƒï¼Ÿ", o: ["é–‹æ”¾ç³»çµ±", "å¯†é–‰ç³»çµ±", "åŠ ç†±ç³»çµ±", "çœŸç©ºç³»çµ±"], a: 1, e: "å¯†é–‰ç³»çµ±èƒ½æœ‰æ•ˆé˜²æ­¢ç‰©è³ªèˆ‡å¤–ç•Œäº¤æ›ã€‚" },
            { q: "é—œæ–¼è³ªé‡å®ˆæ†ï¼Œåæ‡‰å‰å¾ŒåŸå­çš„ç¨®é¡èˆ‡æ•¸ç›®é—œä¿‚ç‚ºä½•ï¼Ÿ", o: ["ç¨®é¡è®Šï¼Œæ•¸ç›®è®Š", "ç¨®é¡ä¸è®Šï¼Œæ•¸ç›®è®Š", "ç¨®é¡è®Šï¼Œæ•¸ç›®ä¸è®Š", "ç¨®é¡ä¸è®Šï¼Œæ•¸ç›®ä¸è®Š"], a: 3, e: "åŸå­ç¨®é¡èˆ‡å€‹æ•¸ä¿æŒä¸è®Šï¼Œæ˜¯è³ªé‡å®ˆæ†çš„å¾®è§€åŸå› ã€‚" },
            { q: "é—œæ–¼è³ªé‡å®ˆæ†å®šå¾‹çš„æ•˜è¿°ï¼Œä¸‹åˆ—ä½•è€…ã€ŒéŒ¯èª¤ã€ï¼Ÿ", o: ["é©ç”¨æ–¼æ²‰æ¾±åæ‡‰", "é©ç”¨æ–¼ç‡ƒç‡’åæ‡‰", "æ ¸åˆ†è£‚åæ‡‰ä¹Ÿå®Œå…¨ç¬¦åˆ", "é–‹æ”¾ç³»çµ±ä¸­å®šå¾‹ä»æˆç«‹"], a: 2, e: "æ ¸åæ‡‰ä¸­è³ªé‡æœƒè½‰åŒ–ç‚ºèƒ½é‡ï¼Œä¸é©ç”¨å‚³çµ±è³ªé‡å®ˆæ†å®šå¾‹ã€‚" }
        ];

        let currentIdx = 0, score = 0, user = {}, detailLog = [];

        function startQuiz() {
            const cls = document.getElementById('class-select').value;
            const ten = document.getElementById('seat-ten').value;
            const one = document.getElementById('seat-one').value;
            const name = document.getElementById('name-input').value;
            if(!cls || one === "" || !name) return alert("è«‹å®Œæ•´å¡«å¯«è³‡è¨Šï¼");
            user = { class: cls, no: (parseInt(ten)*10 + parseInt(one)).toString().padStart(2, '0'), name: name };
            document.getElementById('login-box').style.display='none';
            document.getElementById('quiz-box').style.display='block';
            loadQ();
        }

        function loadQ() {
            const q = questions[currentIdx];
            document.getElementById('q-header').innerText = `é€²åº¦ï¼š${currentIdx+1} / 10`;
            document.getElementById('q-text').innerText = q.q;
            const area = document.getElementById('q-options');
            area.innerHTML = "";
            document.getElementById('feedback-box').style.display = "none";
            q.o.forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = `${String.fromCharCode(65+i)}. ${opt}`;
                btn.onclick = () => check(i);
                area.appendChild(btn);
            });
        }

        function check(idx) {
            const q = questions[currentIdx], fb = document.getElementById('feedback-box');
            document.querySelectorAll('.option-btn').forEach(b => b.disabled = true);
            fb.style.display = "block";
            if(idx === q.a) {
                score += 10;
                detailLog.push("å°");
                document.getElementById('fb-title').innerText = "âœ… å›ç­”æ­£ç¢º";
                fb.className = "fb-correct";
            } else {
                detailLog.push("éŒ¯");
                document.getElementById('fb-title').innerText = "âŒ å›ç­”éŒ¯èª¤";
                fb.className = "fb-wrong";
            }
            document.getElementById('fb-text').innerHTML = `<b>æ­£ç¢ºç­”æ¡ˆï¼š${String.fromCharCode(65+q.a)}</b><br>è§£æï¼š${q.e}`;
        }

        function nextQ() {
            if(++currentIdx < questions.length) loadQ();
            else upload();
        }

function upload() {
    document.getElementById('quiz-box').style.display = 'none';
    document.getElementById('result-box').style.display = 'block';
    document.getElementById('score-display').innerText = score + " åˆ†";
    
    // ä½¿ç”¨ URLSearchParams ç¢ºä¿åƒæ•¸ç·¨ç¢¼æ­£ç¢ºï¼Œè§£æ±ºäº‚ç¢¼æˆ–ç„¡æ³•ç´€éŒ„çš„å•é¡Œ
    const params = new URLSearchParams({
        class: user.class,
        no: user.no,
        name: user.name,
        score: score,
        details: detailLog.join(",")
    });

    const finalUrl = `${script_url}?${params.toString()}`;

    // ä½¿ç”¨ GET æ¨¡å¼ç™¼é€
    fetch(finalUrl, { method: 'GET', mode: 'no-cors' })
    .then(() => { 
        document.getElementById('upload-status').innerText = "âœ… æˆç¸¾èˆ‡æ˜ç´°å·²æˆåŠŸè¨˜éŒ„";
        document.getElementById('upload-status').style.color = "#27ae60";
    })
    .catch((err) => {
        console.error(err);
        document.getElementById('upload-status').innerText = "âŒ ä¸Šå‚³å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯";
        document.getElementById('upload-status').style.color = "#e74c3c";
    });
}
    </script>
</body>

</html>
