<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸå­é‡ã€åˆ†å­é‡ã€è«è€³ - é¾é’åºœè€å¸«</title>
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root { --primary: #2980b9; --success: #27ae60; --error: #e74c3c; --dark: #2c3e50; --bg: #f4f7f6; --banner: #34495e; }
        body { font-family: "Microsoft JhengHei", sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; }
        .header-banner { background: var(--banner); color: white; padding: 20px; text-align: center; position: fixed; width: 100%; top: 0; z-index: 1000; }
        .header-banner h1 { margin: 0; letter-spacing: 5px; font-size: 24px; }
        .container { display: flex; margin-top: 70px; }
        .sidebar { width: 220px; background: var(--dark); padding: 25px 15px; height: calc(100vh - 70px); position: fixed; top: 70px; display: flex; flex-direction: column; gap: 15px; }
        .sidebar button { padding: 15px; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px; }
        .sidebar button.active { background: var(--primary); border: 2px solid #fff; }
        .main-content { margin-left: 250px; padding: 40px; flex-grow: 1; display: flex; flex-direction: column; align-items: center; }
        .quiz-card { background: white; width: 100%; max-width: 650px; padding: 35px; border-radius: 15px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); text-align: center; }
        .form-group { text-align: left; margin-bottom: 20px; }
        select, input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        .seat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .question-text { font-size: 22px; margin: 25px 0; text-align: left; line-height: 1.6; }
        .options-grid { display: grid; gap: 12px; }
        .option-btn { padding: 15px; font-size: 18px; border: 2px solid #ddd; border-radius: 10px; background: white; cursor: pointer; text-align: left; }
        .option-btn:hover:not(:disabled) { border-color: var(--primary); background: #f0f7ff; }
        #feedback-box { display: none; margin-top: 20px; padding: 20px; border-radius: 10px; text-align: left; }
        .fb-correct { background: #d4edda; border: 2px solid #28a745; color: #155724; }
        .fb-wrong { background: #f8d7da; border: 2px solid #dc3545; color: #721c24; }
        .calc-area { background: #fdf6e3; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 5px solid #b58900; }
        .calc-input { width: 80px; text-align: center; border: 1px solid #999; border-radius: 4px; padding: 5px; }
    </style>
</head>
<body>

    <div class="header-banner"><h1>åŸå­é‡ã€åˆ†å­é‡ã€è«è€³</h1></div>

    <div class="container">
        <div class="sidebar">
            <button style="background:#9b59b6;" onclick="window.open('Atomic_molecular.pdf', '_blank')">ğŸ“„ é–±è®€è¬›ç¾©</button>
            <button class="active" onclick="location.reload()">âœï¸ ç·šä¸Šæ¸¬é©—</button>
            <button style="background:#e67e22; margin-top: auto;" onclick="location.href='../index.html'">ğŸ  å›é¦–é </button>
        </div>

        <div class="main-content">
            <div id="login-box" class="quiz-card">
                <h2>ğŸ§ª è©•é‡è³‡è¨Šç™»éŒ„</h2>
                <div class="form-group"><label>ç­ç´šï¼š</label>
                    <select id="user-class">
                        <option value="">é¸æ“‡ç­ç´š</option>
                        <option value="801">801</option><option value="802">802</option>
                        <option value="803">803</option><option value="804">804</option><option value="805">805</option>
                    </select>
                </div>
                <div class="form-group"><label>åº§è™Ÿï¼š</label>
                    <div class="seat-grid">
                        <select id="no-ten"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option></select>
                        <select id="no-one"><option value="">å€‹ä½</option><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option></select>
                    </div>
                </div>
                <div class="form-group"><label>å§“åï¼š</label><input type="text" id="user-name" placeholder="è¼¸å…¥å§“å"></div>
                <button onclick="startQuiz()" style="width:100%; padding:15px; background:var(--success); color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">é€²å…¥æ¸¬é©—</button>
            </div>

            <div id="quiz-box" class="quiz-card" style="display:none;">
                <div id="q-header" style="color:var(--primary); font-weight:bold;"></div>
                <div id="q-content"></div>
                <div id="feedback-box">
                    <div id="fb-title" style="font-weight:bold;"></div>
                    <div id="fb-text"></div>
                    <button onclick="nextQ()" style="margin-top:15px; padding:10px 25px; background:var(--primary); color:white; border:none; border-radius:8px; cursor:pointer;">ä¸‹ä¸€é¡Œ</button>
                </div>
            </div>

            <div id="result-box" class="quiz-card" style="display:none;">
                <h2>è©•é‡å®Œæˆ</h2>
                <h1 id="score-display" class="score-box" style="font-size:72px; color:var(--error);">0</h1>
                <p id="upload-status">æˆç¸¾ç™»éŒ„ä¸­...</p>
                <button onclick="location.reload()">é‡æ–°æ¸¬é©—</button>
            </div>
        </div>
    </div>

<script>
    const script_url = "https://script.google.com/macros/s/AKfycbxbTfbQYeKSv_0oi_g8DBYF9g4K0cnOHePfhnFAjInMW8g0tYn6kTJNGarJ_0EL4jdn/exec";
    
    const questions = [
        // è§€å¿µé¡Œ (1-10)
        {type:"radio", q:"é—œæ–¼åŸå­é‡çš„æ•˜è¿°ï¼Œä½•è€…æ­£ç¢ºï¼Ÿ", o:["åŸå­é‡æœ‰å–®ä½(g)","åŸå­é‡æ˜¯çœŸå¯¦è³ªé‡","ç›®å‰ä»¥ç¢³-12ç‚ºæ¯”è¼ƒæ¨™æº–","åŸå­é‡ç”±ç¢³åŸå­çœŸå¯¦è³ªé‡å®šç¾©"], a:2, e:"åŸå­é‡æ˜¯ç›¸å°æ¯”è¼ƒçš„æ•¸å€¼ï¼Œç›®å‰ä»¥ç¢³-12=12.0000ç‚ºæ¨™æº–ã€‚"},
        {type:"radio", q:"1 è«è€³çš„ç‰©è³ªæ‰€å«çš„ç²’å­æ•¸å¤§ç´„æ˜¯å¤šå°‘å€‹ï¼Ÿ", o:["\\(6 \\times 10^{22}\\)","\\(6 \\times 10^{23}\\)","\\(1.2 \\times 10^{23}\\)","\\(3 \\times 10^{23}\\)"], a:1, e:"1 è«è€³å®šç¾©ç‚º \\(6 \\times 10^{23}\\) å€‹ç²’å­ã€‚"},
        {type:"radio", q:"å·²çŸ¥ç¢³åŸå­é‡ç‚º 12ï¼Œå‰‡ 12 å…¬å…‹çš„ç¢³åŸå­ä¸­å«æœ‰å¤šå°‘å€‹ç¢³åŸå­ï¼Ÿ", o:["12 å€‹","\\(6 \\times 10^{23}\\) å€‹","1 å€‹","\\(1.2 \\times 10^{24}\\) å€‹"], a:1, e:"12å…¬å…‹å³ 1 è«è€³ç¢³ï¼Œå«äºä½›åŠ å¾·ç¾…æ•¸å€‹åŸå­ã€‚"},
        {type:"radio", q:"ä¸‹åˆ—ä½•è€…ä»£è¡¨ã€Œåˆ†å­é‡ã€ï¼Ÿ", o:["1 å€‹åˆ†å­çš„è³ªé‡","1 è«è€³åˆ†å­çš„è³ªé‡(g)åœ¨æ•¸å€¼ä¸Šçš„å±•ç¾","åˆ†å­çš„å¯†åº¦","åˆ†å­çš„é«”ç©"], a:1, e:"åˆ†å­é‡åœ¨æ•¸å€¼ä¸Šç­‰æ–¼ 1 è«è€³ç‰©è³ªçš„è³ªé‡ã€‚"},
        {type:"radio", q:"è‹¥æ°§åŸå­é‡ç”± 16 è®Š 32ï¼Œå‰‡ 1 è«è€³æ°§æ°£ (\\(O_2\\)) çš„ã€ŒçœŸå¯¦ã€è³ªé‡ï¼Ÿ", o:["è®Šé‡","è®Šè¼•","ä¸è®Š","è®Šå…©å€"], a:2, e:"äººç‚ºå®šç¾©æ”¹è®Šä¸æœƒå½±éŸ¿çœŸå¯¦ç‰©ç†è³ªé‡ã€‚"},
        {type:"radio", q:"1 è«è€³äºŒæ°§åŒ–ç¢³ (\\(CO_2\\)) å«æœ‰å¤šå°‘è«è€³æ°§åŸå­ï¼Ÿ", o:["1","2","3","44"], a:1, e:"ä¸€å€‹ \\(CO_2\\) æœ‰å…©å€‹æ°§åŸå­ã€‚"},
        {type:"radio", q:"0.5 è«è€³æ°´åˆ†å­ (\\(H_2O\\)) ä¸­å«æœ‰å¹¾è«è€³åŸå­ï¼Ÿ", o:["0.5","1","1.5","3"], a:2, e:"\\(0.5 \\times 3 = 1.5\\) è«è€³åŸå­ã€‚"},
        {type:"radio", q:"è«è€³ (mole) æ˜¯å“ªä¸€ç¨®ç‰©ç†é‡çš„å–®ä½ï¼Ÿ", o:["è³ªé‡","é‡é‡","ç²’å­æ•¸é‡","å¯†åº¦"], a:2, e:"è«è€³æ˜¯è¨ˆç®—æ•¸é‡çš„å–®ä½ã€‚"},
        {type:"radio", q:"18 å…¬å…‹æ°´ (\\(H_2O\\)) èˆ‡ 18 å…¬å…‹äºŒæ°§åŒ–ç¢³ (\\(CO_2\\)) èª°åˆ†å­æ•¸å¤šï¼Ÿ", o:["æ°´åˆ†å­è¼ƒå¤š","äºŒæ°§åŒ–ç¢³åˆ†å­è¼ƒå¤š","ä¸€æ¨£å¤š","ç„¡æ³•æ¯”è¼ƒ"], a:0, e:"åŒæ¨£è³ªé‡ä¸‹ï¼Œåˆ†å­é‡è¶Šå°åˆ†å­æ•¸è¶Šå¤šã€‚"},
        {type:"radio", q:"åŸå­é‡æ˜¯ç”±ç§‘å­¸å®¶å”è­°è¨‚å‡ºçš„ã€Œç›¸å°ã€æ•¸å€¼ï¼Œå°å—ï¼Ÿ", o:["å°","ä¸å°"], a:0, e:"æ˜¯çš„ã€‚"},

        // åˆ†å­é‡å¡«ç©º (11-15)
        {type:"mw", q:"è¨ˆç®— äºŒæ°§åŒ–ç¢³ (\\(CO_2\\)) åˆ†å­é‡ï¼š", s:"12 + 16 \\(\\times\\) ", sa:2, ans:44, e:"\\(C=12, O=16 \\times 2\\)ã€‚"},
        {type:"mw", q:"è¨ˆç®— æ°´ (\\(H_2O\\)) åˆ†å­é‡ï¼š", s:"1 \\(\\times\\) 2 +", sa:16, ans:18, e:"\\(H=1 \\times 2, O=16\\)ã€‚"},
        {type:"mw", q:"è¨ˆç®— æ°«æ°§åŒ–éˆ‰ (NaOH) åˆ†å­é‡ï¼š", s:"23 + 16 +", sa:1, ans:40, e:"Na=23, O=16, H=1ã€‚"},
        {type:"mw", q:"è¨ˆç®— ç¡«é…¸ (\\(H_2SO_4\\)) åˆ†å­é‡ï¼š", s:"1 \\(\\times\\) 2 + 32 + 16 \\(\\times\\) ", sa:4, ans:98, e:"H=2, S=32, O=64ã€‚"},
        {type:"mw", q:"è¨ˆç®— è‘¡è„ç³– (\\(C_6H_{12}O_6\\)) åˆ†å­é‡ï¼š", s:"12 \\(\\times\\) 6 + 1 \\(\\times\\) 12 + 16 \\(\\times\\) ", sa:6, ans:180, e:"12x6 + 1x12 + 16x6ã€‚"},

        // è«è€³è½‰æ› (16-25)
        {type:"mole", q:"å·²çŸ¥ 36 å…¬å…‹ æ°´ (\\(H_2O=18\\))", l:["è«è€³æ•¸","æ•¸é‡ (\\(\\times 6 \\times 10^{23}\\))"], a:[2,2], e:"36 / 18 = 2 è«è€³ã€‚"},
        {type:"mole", q:"å·²çŸ¥ 88 å…¬å…‹ äºŒæ°§åŒ–ç¢³ (\\(CO_2=44\\))", l:["è«è€³æ•¸","æ•¸é‡ (\\(\\times 6 \\times 10^{23}\\))"], a:[2,2], e:"88 / 44 = 2 è«è€³ã€‚"},
        {type:"mole", q:"å·²çŸ¥ 4 å…¬å…‹ æ°«æ°£ (\\(H_2=2\\))", l:["è«è€³æ•¸","æ•¸é‡ (\\(\\times 6 \\times 10^{23}\\))"], a:[2,2], e:"4 / 2 = 2 è«è€³ã€‚"},
        {type:"mole", q:"å·²çŸ¥ 160 å…¬å…‹ æ°§åŒ–éµ (\\(Fe_2O_3=160\\))", l:["è«è€³æ•¸","æ•¸é‡ (\\(\\times 6 \\times 10^{23}\\))"], a:[1,1], e:"1 è«è€³ã€‚"},
        {type:"mole", q:"å·²çŸ¥ 2 è«è€³ æ°§æ°£ (\\(O_2=32\\))", l:["è³ªé‡ (g)","æ•¸é‡ (\\(\\times 6 \\times 10^{23}\\))"], a:[64,2], e:"2 \\(\times\\) 32 = 64gã€‚"},
        {type:"mole", q:"å·²çŸ¥ 0.5 è«è€³ ç¡«é…¸ (\\(H_2SO_4=98\\))", l:["è³ªé‡ (g)","æ•¸é‡ (\\(\\times 6 \\times 10^{23}\\))"], a:[49,0.5], e:"0.5 \\(\times\\) 98 = 49gã€‚"},
        {type:"mole", q:"å·²çŸ¥ 3 è«è€³ ç¢³åŸå­ (C=12)", l:["è³ªé‡ (g)","æ•¸é‡ (\\(\\times 6 \\times 10^{23}\\))"], a:[36,3], e:"3 \\(\times\\) 12 = 36gã€‚"},
        {type:"mole", q:"å·²çŸ¥ \\(1.2 \\times 10^{24}\\) å€‹ æ°´åˆ†å­ (\\(H_2O=18\\))", l:["è«è€³æ•¸","è³ªé‡ (g)"], a:[2,36], e:"2 è«è€³æ°´ã€‚"},
        {type:"mole", q:"å·²çŸ¥ \\(3 \\times 10^{23}\\) å€‹ æ°«æ°£ (\\(H_2=2\\))", l:["è«è€³æ•¸","è³ªé‡ (g)"], a:[0.5,1], e:"0.5 è«è€³æ°«æ°£ã€‚"},
        {type:"mole", q:"å·²çŸ¥ \\(6 \\times 10^{24}\\) å€‹ ç¢³åŸå­ (C=12)", l:["è«è€³æ•¸","è³ªé‡ (g)"], a:[10,120], e:"10 è«è€³ç¢³ã€‚"}
    ];

    let currentIdx = 0, score = 0, user = {}, detailLog = [];

    function startQuiz() {
        const cls = document.getElementById('user-class').value;
        const ten = document.getElementById('no-ten').value;
        const one = document.getElementById('no-one').value;
        const name = document.getElementById('user-name').value;
        if(!cls || one === "" || !name) return alert("è³‡è¨Šä¸å®Œæ•´ï¼");
        user = { class: cls, no: (parseInt(ten)*10 + parseInt(one)).toString().padStart(2, '0'), name: name };
        document.getElementById('login-box').style.display='none';
        document.getElementById('quiz-box').style.display='block';
        loadQuestion();
    }

    function loadQuestion() {
        const q = questions[currentIdx], area = document.getElementById('q-content'), head = document.getElementById('q-header');
        document.getElementById('feedback-box').style.display = "none";
        head.innerText = `é¡Œç›®é€²åº¦ï¼š${currentIdx+1} / ${questions.length}`;
        let html = `<div class="question-text">${q.q}</div>`;

        if(q.type === "radio") {
            html += `<div class="options-grid">`;
            q.o.forEach((opt, i) => html += `<button class="option-btn" onclick="checkRadio(${i})">${String.fromCharCode(65+i)}. ${opt}</button>`);
            html += `</div>`;
        } else if(q.type === "mw") {
            html += `<div class="calc-area">æ­¥é©Ÿï¼š${q.s} <input type="number" id="ans-s" class="calc-input"></div>`;
            html += `æœ€çµ‚ç­”æ¡ˆï¼š<input type="number" id="ans-a" class="calc-input">`;
            html += `<br><button class="option-btn" style="margin-top:15px; width:100%; text-align:center;" onclick="checkCalc()">æª¢æŸ¥ç­”æ¡ˆ</button>`;
        } else if(q.type === "mole") {
            html += `<div class="calc-area">${q.l[0]}ï¼š<input type="number" id="ans-1" class="calc-input"><br><br>${q.l[1]}ï¼š<input type="number" id="ans-2" class="calc-input"></div>`;
            html += `<button class="option-btn" style="width:100%; text-align:center;" onclick="checkMole()">æª¢æŸ¥ç­”æ¡ˆ</button>`;
        }
        area.innerHTML = html;
        if (window.MathJax) MathJax.typesetPromise();
    }

    function showFB(isCorrect, text) {
        const fb = document.getElementById('feedback-box');
        fb.style.display = "block";
        fb.className = isCorrect ? "fb-correct" : "fb-wrong";
        document.getElementById('fb-title').innerText = isCorrect ? "âœ… å›ç­”æ­£ç¢º" : "âŒ å›ç­”éŒ¯èª¤";
        document.getElementById('fb-text').innerHTML = text;
        detailLog.push(isCorrect ? "å°" : "éŒ¯");
        if(isCorrect) score += (currentIdx < 10 ? 3 : (currentIdx < 15 ? 4 : 5));
        document.querySelectorAll('.option-btn').forEach(b => b.disabled = true);
        if (window.MathJax) MathJax.typesetPromise();
    }

    function checkRadio(idx) {
        const q = questions[currentIdx];
        showFB(idx === q.a, `æ­£ç¢ºç­”æ¡ˆï¼š${String.fromCharCode(65+q.a)}<br>è§£æï¼š${q.e}`);
    }

    function checkCalc() {
        const q = questions[currentIdx], s = parseFloat(document.getElementById('ans-s').value), a = parseFloat(document.getElementById('ans-a').value);
        showFB(s === q.sa && a === q.ans, `æ­£ç¢ºï¼šæ­¥é©Ÿå¡«å…¥ ${q.sa}ï¼Œåˆ†å­é‡ç‚º ${q.ans}`);
    }

    function checkMole() {
        const q = questions[currentIdx], v1 = parseFloat(document.getElementById('ans-1').value), v2 = parseFloat(document.getElementById('ans-2').value);
        showFB(v1 === q.a[0] && v2 === q.a[1], `æ­£ç¢ºï¼š${q.l[0]}=${q.a[0]}, ${q.l[1]}=${q.a[1]}`);
    }

    function nextQ() {
        if(++currentIdx < questions.length) loadQuestion();
        else upload();
    }

    function upload() {
        document.getElementById('quiz-box').style.display='none';
        document.getElementById('result-box').style.display='block';
        document.getElementById('score-display').innerText = score;
        const params = new URLSearchParams({ class: user.class, no: user.no, name: user.name, score: score, details: detailLog.join(",") });
        fetch(`${script_url}?${params.toString()}`, { method: 'GET', mode: 'no-cors' })
        .then(() => document.getElementById('upload-status').innerText = "âœ… æˆç¸¾å·²ç™»éŒ„");
    }
</script>
</body>
</html>